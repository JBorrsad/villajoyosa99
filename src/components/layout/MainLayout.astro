---
import { asset } from '../../utils/assets';
import '../../styles/global.css';

interface Props {
	title: string;
	description: string;
	keywords?: string;
}

const { title, description, keywords } = Astro.props;
const currentYear = new Date().getFullYear();
---

<!DOCTYPE html>
<html lang="es">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<!-- Favicon para modo claro -->
	<link rel="icon" type="image/png" href={asset("/logo/logo.png")} media="(prefers-color-scheme: light)" />
	<link rel="icon" type="image/png" sizes="32x32" href={asset("/logo/logo.png")} media="(prefers-color-scheme: light)" />
	<link rel="icon" type="image/png" sizes="192x192" href={asset("/logo/logo.png")} media="(prefers-color-scheme: light)" />
	<link rel="icon" type="image/png" sizes="512x512" href={asset("/logo/logo.png")} media="(prefers-color-scheme: light)" />
	<link rel="apple-touch-icon" sizes="180x180" href={asset("/logo/logo.png")} media="(prefers-color-scheme: light)" />
	
	<!-- Favicon para modo oscuro -->
	<link rel="icon" type="image/png" href={asset("/logo/white.png")} media="(prefers-color-scheme: dark)" />
	<link rel="icon" type="image/png" sizes="32x32" href={asset("/logo/white.png")} media="(prefers-color-scheme: dark)" />
	<link rel="icon" type="image/png" sizes="192x192" href={asset("/logo/white.png")} media="(prefers-color-scheme: dark)" />
	<link rel="icon" type="image/png" sizes="512x512" href={asset("/logo/white.png")} media="(prefers-color-scheme: dark)" />
	<link rel="apple-touch-icon" sizes="180x180" href={asset("/logo/white.png")} media="(prefers-color-scheme: dark)" />
	
	<!-- Favicon por defecto (fallback) -->
	<link rel="icon" type="image/png" href={asset("/logo/logo.png")} />
	<meta name="generator" content={Astro.generator} />
	
	<!-- Preload recursos críticos -->
	<link rel="preload" href="https://fonts.gstatic.com/s/lora/v32/0QI6MX1D_JOuGQbT0gvTJPa787weuxJBkq0.woff2" as="font" type="font/woff2" crossorigin />
	<link rel="preload" href="https://fonts.gstatic.com/s/publicsans/v15/ijwGs572Xtc6ZYQws9YVwllKVG8qX1oyOymuFpmJygco.woff2" as="font" type="font/woff2" crossorigin />
	
	<!-- SEO Meta Tags -->
	<title>{title}</title>
	<meta name="description" content={description} />
	{keywords && <meta name="keywords" content={keywords} />}
	<meta name="author" content="Clínica Dental Villajoyosa 99" />
	
	<!-- Open Graph -->
	<meta property="og:title" content="Clínica Dental Villajoyosa 99" />
	<meta property="og:description" content="Más de 25 años cuidando sonrisas en Madrid. Tu clínica dental de confianza en Villaverde con los mejores profesionales y la medicina más avanzada." />
	<meta property="og:type" content="website" />
	<meta property="og:url" content="https://jborrsad.github.io/villajoyosa99/" />
	<meta property="og:image" content="https://jborrsad.github.io/villajoyosa99/logo/logo.png" />
	<meta property="og:image:secure_url" content="https://jborrsad.github.io/villajoyosa99/logo/logo.png" />
	<meta property="og:image:type" content="image/png" />
	<meta property="og:image:width" content="512" />
	<meta property="og:image:height" content="512" />
	<meta property="og:image:alt" content="Logo Clínica Dental Villajoyosa 99" />
	<meta property="og:locale" content="es_ES" />
	<meta property="og:site_name" content="Clínica Dental Villajoyosa 99" />
	<meta property="fb:app_id" content="0" />
	
	<!-- Twitter Card -->
	<meta name="twitter:card" content="summary" />
	<meta name="twitter:title" content="Clínica Dental Villajoyosa 99" />
	<meta name="twitter:description" content="Más de 25 años cuidando sonrisas en Madrid. Tu clínica dental de confianza en Villaverde con los mejores profesionales y la medicina más avanzada." />
	<meta name="twitter:image" content="https://jborrsad.github.io/villajoyosa99/logo/logo.png" />
	<meta name="twitter:image:alt" content="Logo Clínica Dental Villajoyosa 99" />
	
	<!-- Fuentes Google Fonts - Optimizado para Core Web Vitals -->
	<link rel="preconnect" href="https://fonts.googleapis.com" />
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
	<link href="https://fonts.googleapis.com/css2?family=Lora:wght@600;700&family=Public+Sans:wght@400;500;600&display=swap" rel="stylesheet" media="print" onload="this.media='all'" />
	<noscript>
		<link href="https://fonts.googleapis.com/css2?family=Lora:wght@600;700&family=Public+Sans:wght@400;500;600&display=swap" rel="stylesheet" />
	</noscript>
	
	<!-- Schema.org Structured Data -->
	<script type="application/ld+json" set:html={JSON.stringify({
		"@context": "https://schema.org",
		"@type": "Dentist",
		"name": "Clínica Dental Villajoyosa 99",
		"image": "https://jborrsad.github.io/villajoyosa99/logo/logo.png",
		"@id": "https://jborrsad.github.io/villajoyosa99/",
		"url": "https://jborrsad.github.io/villajoyosa99/",
		"telephone": "+34917988669",
		"priceRange": "€€",
		"address": {
			"@type": "PostalAddress",
			"streetAddress": "Calle de Villajoyosa, 99",
			"addressLocality": "Madrid",
			"addressRegion": "Madrid",
			"postalCode": "28041",
			"addressCountry": "ES"
		},
		"geo": {
			"@type": "GeoCoordinates",
			"latitude": 40.3456,
			"longitude": -3.6931
		},
		"openingHoursSpecification": [
			{
				"@type": "OpeningHoursSpecification",
				"dayOfWeek": ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"],
				"opens": "10:00",
				"closes": "14:00"
			},
			{
				"@type": "OpeningHoursSpecification",
				"dayOfWeek": ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"],
				"opens": "16:30",
				"closes": "20:00"
			},
			{
				"@type": "OpeningHoursSpecification",
				"dayOfWeek": ["Saturday"],
				"opens": "10:00",
				"closes": "13:30"
			}
		]
	})} />
</head>
<body>
	<slot />
	
	<!-- Script para optimizar rendimiento -->
	<script>
		// Cambiar favicon según el modo oscuro/claro
		function updateFavicon() {
			const isDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
			const favicon = (document.querySelector('link[rel="icon"]:not([media])') || document.querySelector('link[rel="icon"]')) as HTMLLinkElement;
			const appleIcon = (document.querySelector('link[rel="apple-touch-icon"]:not([media])') || document.querySelector('link[rel="apple-touch-icon"]')) as HTMLLinkElement;
			
			const darkLogo = '{whiteLogoUrl}';
			const lightLogo = '{logoUrl}';
			
			if (favicon) {
				favicon.href = isDark ? darkLogo : lightLogo;
			}
			if (appleIcon) {
				appleIcon.href = isDark ? darkLogo : lightLogo;
			}
		}
		
		// Actualizar al cargar
		updateFavicon();
		
		// Escuchar cambios en el modo oscuro/claro
		window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', updateFavicon);
		
		// Prefetch de enlaces al hacer hover (mejora la navegación)
		document.addEventListener('DOMContentLoaded', () => {
			const links = document.querySelectorAll('a[href^="/"], a[href^="#"]');
			const prefetchedLinks = new Set();
			
			const prefetchLink = (url) => {
				if (prefetchedLinks.has(url) || url.startsWith('#')) return;
				prefetchedLinks.add(url);
				
				const link = document.createElement('link');
				link.rel = 'prefetch';
				link.href = url;
				document.head.appendChild(link);
			};
			
			links.forEach(link => {
				link.addEventListener('mouseenter', () => {
					const href = link.getAttribute('href');
					if (href) prefetchLink(href);
				}, { once: true, passive: true });
			});
		});
	</script>
</body>
</html>

